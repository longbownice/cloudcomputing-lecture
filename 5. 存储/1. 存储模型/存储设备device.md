# 存储方式

​	对接具体的存储设备。

根据存储类型，对于SAN存储，可以是IP-SAN、FC-SAN、NFS存储方式，对于分布式存储，可以是Ceph、EBS、GFS存储。

 

对存储设备的基本使用场景如下：

​	物理磁盘àRAID（远端磁盘的冗余方式）à逻辑磁盘（LUN，即呈献给主机的存储单元unit连接信息，一般对应的是/dev/vmc/目录下的超链接）à主机OS识别出LUNà上层使用，有三种方式：

1、 直接使用块设备（LUN透传）

2、 划分LVM（PV-VG-LV）

3、 挂载（gfs挂载到/opt/zxve/storage/UNIT-***/dev/vmc/serial-***）

à创建文件系统à用户可识别直接操作的文件夹

 

# 磁盘

# 数据总线

参考：http://www.bubuko.com/infodetail-3106729.html

南桥和北桥芯片

南桥主要是负责IO，北桥用于CPU和内存、显卡、PCI交换数据以及和南桥通信。

## PCI总线

PCI是Peripheral Component Interconnect(外设部件互连标准)的缩写，它是目前个人电脑中使用最为广泛的接口，几乎所有的主板产品上都带有这种插槽。PCI插槽也是主板带有最多数量的插槽类型，在目前流行的台式机主板上，ATX结构的主板一般带有5～6个PCI插槽，而小一点的MATX主板也都带有2～3个PCI插槽。最新的总线有PCI-E。

 

## SCSI接口

小型计算机系统接口（英语：Small Computer System Interface; 简写：SCSI），一种用于计算机和智能设备之间（硬盘、光驱、打印机、扫描仪等）系统级接口的独立处理器标准。

 

## EISA总线

EISA(Extended Industry Standard Architecture:扩展工业标准结构）1989年工业厂商联盟为32位CPU设计的总线扩展标准，兼容ISA总线，现已被淘汰。

ISA也是非常老的总线，最多支持16bit，数据带宽较低；EISA是ISA的增强，数据带宽有提升，这两种总线已经淘汰了。PCI是应用最广泛的总线，支持32bit、64bit数据，支持33MHz～66MHz，数据带宽较高，但也是比较旧的的。最新的有PCI-E等等。

 

## COM接口

电脑上的COM接口是用来链接老式的设备比如游戏手柄、包括老的鼠标、键盘、音响、打印机等等，是相当于USB的作用。

 

# 设备接口

​	存储设备根据接口可以分为：IDE、ATA、SATA（串行ATA）、SCSI（小型计算机接口）、SAS（串行SCSI）、SSD，分别对应IDE磁盘、SATA盘、SCSI盘、SAS盘、SSD盘。

## IDE/ATA

​	IDE（Intergrated Device Electronics，即电子集成驱动器）硬盘也叫ATA硬盘，是采用并行传输技术的硬盘。

​	IDE硬盘的接口类型：ATA、Ultra ATA、DMA、Ultra DMA

​	IDE硬盘优点：价格低廉、兼容性强、性价比高

​	IDE硬盘缺点：数据传输速度慢、线缆长度过短、连接设备少

 

## SATA

​	SATA全称是Serial Advanced Technology Attachment（串行高级技术附件，一种基于行业标准的串行硬件驱动器接口），其实是Serial ATA，即***\*串行\****ATA。SATA设计的目的就是取代并行的ATA，第三版的SATA最高传输速度可以达到6Gb/s（大概715MB/s）。SATA是可热插拔的，使用7针脚的窄连接线。

​	SATA硬盘优点：传输速度快、安装方便、容易散热、支持热插拔

**SATA硬盘和IDE硬盘比较**

　　SATA硬盘采用新的设计结构，数据传输快，节省空间，相对于IDE硬盘具有很多优势：

　　1、SATA硬盘比IDE硬盘传输速度高。目前SATA可以提供150MB/s的高峰传输速率。今后将达到300 MB/s和600 MB/s。到时我们将得到比IDE硬盘快近10倍的传输速率。

　　2、相对于IDE硬盘的PATA40针的数据线，SATA的线缆少而细，传输距离远，可延伸至1米，使得安装设备和机内布线更加容易。连接器的体积小，这种线缆有效的改进了计算机内部的空气流动，也改善了机箱内的散热。

　　3、相对于IDE硬盘系统功耗有所减少。SATA硬盘使用500毫伏的电压就可以工作。

　　4、SATA可以通过使用多用途的芯片组或串行——并行转换器来向后兼容PATA设备。由于SATA和PATA可使用同样的驱动器，不需要对操作系统进行升级或其他改变。

　　5、SATA不需要设置主从盘跳线。BIOS会为它按照1、2、3顺序编号。这取决于驱动器接在哪个SATA连接器上（安装方便）。而IDE硬盘需要设置通过跳线来设置主从盘。

　　6、SATA还支持热插拔，可以象U盘一样使用。而IDE硬盘不支持热插拔。

## SCSI

​	SCSI是Small Computer System Interface的缩写，被用于连接硬盘和磁带机以外还可以连接其他外设。

​	相对于IDE设备，SCSI设备一般贵一点，速度快、稳定性好、比较适合做磁盘阵列。

​	SCSI硬盘优点：

1、 磁盘平均寻道时间短；

2、 支持多种设备；

3、 SCSI还需要在对一个设备传输数据的同时，另一个设备对其进行数据查找；

4、 占用CPU极低，在多任务系统中有着明显优势。由于SCSI卡本身带有CPU，可处理一切SCSI设备的事务，在工作时主机CPU只要向SCSI卡发出工作指令，SCSI卡就会自己进行工作，工作结束后返回工作结果给CPU，在整个过程中，CPU可以进行自身的工作。

## SAS

​	Serial Attached SCSI，即***\*串行SCSI\****，是SCSI的优化版本，且兼容SATA。

​	

SAS的接口技术可以向下兼容SATA。具体来说，二者的兼容性主要体现在物理层和协议层的兼容。

在物理层，SAS接口和SATA接口完全兼容，SATA硬盘可以直接使用在SAS的环境中，从接口标准上而言，SATA是SAS的一个子标准，因此SAS控制器可以直接操控SATA硬盘，但是SAS却不能直接使用在SATA的环境中，因为SATA控制器并不能对SAS硬盘进行控制。

在协议层，SAS由3种类型协议组成，根据连接的不同设备使用相应的协议进行数据传输。其中串行SCSI协议(SSP)用于传输SCSI命令；SCSI管理协议(SMP)用于对连接设备的维护和管理；SATA通道协议(STP)用于SAS和SATA之间数据的传输。因此在这3种协议的配合下，SAS可以和SATA以及部分SCSI设备无缝结合。

 

​	**SAS与FC**

​	SAS网络与FC的本质区别：SAS为全交换式架构，不像FC一样有Fabric和FCAL两种架构，如果让一个控制器Initiator和多块磁盘作为网络节点直接连接到SAS网络中的话，那么控制器和所有磁盘之间都是全双工线速无阻交换的，控制器可以直接向任何一个磁盘收发数据，同样，磁盘也可以在任何时刻直接向控制器发送数据。

## SSD

SSD是摒弃传统磁介质，采用电子存储介质进行数据存储和读取的一种技术，突破了传统机械硬盘的性能瓶颈，拥有极高的存储性能，被认为是存储技术发展的未来新星。

​	SSD的成本比SAS高很多，大约十倍。SSD的持续I/O性能可以达到SAS和SATA的40~60倍。SSD容量已增至600GB，但是仍远低于SAS和SATA。

 

固态硬盘的全集成电路化、无任何机械运动部件的革命性设计，从根本上解决了在移动办公环境下，对于数据读写稳定性的需求。全集成电路化设计可以让固态硬盘做成任何形状。与传统硬盘相比，SSD固态电子盘具有以下优点：

　　1、SSD不需要机械结构，完全的半导体化，不存在数据查找时间、延迟时间和磁盘寻道时间，数据存取速度快，读取数据的能力在100M/s以上，最高的目前可达300M/s。

　　2、SSD全部采用闪存芯片，经久耐用，防震抗摔，即使发生与硬物碰撞，数据丢失的可能性也能够降到最小。

　　3、得益于无机械部件及FLASH闪存芯片，SSD没有任何噪音，功耗低。

4、质量轻，比常规1.8英寸硬盘重量轻20-30克，使得便携设备搭载多块SSD成为可能。同时因其完全半导体化，无结构限制，可根据实际情况设计成各种不同接口、形状的特殊电子硬盘。

 

​	当企业业务对性能的需求大于对成本和容量的因素的时候，SSD是最佳选择，特别适合往往需要最高随机读取和写入性能的最关键业务应用。

 

## FC

FC(Fiber Channel光纤通道)接口硬盘。

 

## NvME

# 磁阵

## JBOD/磁阵

### 磁盘柜

​	如果主机上安装的是不带RAID功能的SCSI卡，主机上电以后，就会识别出磁盘箱）上的所有磁盘，此时，磁盘箱中有多少磁盘，系统就识别多少块磁盘，在系统磁盘管理器中就会显示多少块磁盘。

如果主机上安装的是带RAID功能的SCSI卡，那么可用RAID卡先对识别出的多块次哦按做一下RAID处理，划分出逻辑盘，此时，操作系统识别出来的就是逻辑磁盘，而不是磁阵上的物理磁盘。

​	这种磁盘箱叫做JBOD，即Just a Bond Of Disk，只是一串磁盘（不带RAID卡）。

### ***\*磁阵\****

对于RAID卡安装在服务器上的情况，如果需要调整RAID的话，需要重启服务器生效，这样必然会影响服务器上本身运行的服务。能否把RAID功能做到磁盘柜中，这样只需要在远端的磁盘柜上做好配置，连接上服务器即可。这种自带RAID控制器的磁盘柜叫做磁阵。

​	一般地，我们成JBOD为磁盘柜/磁盘箱，自带RAID控制器的磁盘柜称为磁盘阵列/磁阵。磁盘柜只是一个外置的磁盘，而磁阵是自带RAID控制器的。

​	注：有的服务器不做RAID直接是识别不出来磁盘设备的。

## RAID

### RAID卡

​	磁阵在磁盘柜的基础上，将内部的磁盘经过自带的RAID控制器进行二次划分后，虚拟出来多个逻辑磁盘，然后经过外部的SCSI总线的一个或者多个设备（多路径），具有一个或者多个SCSI ID，所有逻辑磁盘都以LUN的形式呈现给主机。

​	注：只要是连接磁阵的，我们看到的都是LUN形式的虚拟磁盘。

### 软RAID

​	还有一种是软件RAID，即系统上面运行RAID软件，然后通过配置界面去设置。

## 虚拟磁盘

​	磁阵可以在一个SCSI ID下虚拟多个LUN地址，每个LUN地址对应一个虚拟磁盘（每个虚拟磁盘可以对应多个物理磁盘），这样就可以在一个总线上生成众多的虚拟磁盘。

​	通常，把硬件层面生成的虚拟磁盘统一称为“LUN”，不管是不是在SCSI环境下；而由软件层面生成的虚拟磁盘，统一称为“卷”，比如各种卷管理软件、软RAID软件生成的虚拟磁盘。

## 卷管理器

## Target/Initor模式

​	

## 前端/后端

## 内部/外部接口

## 多外部接口

## 双控制器

# 分布式**存储IO	

## 本地LVM存储

​	在本地/dev目录下的sd*代表SATA磁盘，hd*代表IDE硬盘。如果做LVM，则对应的是dm-*块设备（dm=deivce mapper），mapper对应的是LVM相关的存储信息，包括本地的、远端的、superpath、multipath。在dev目录下还存在vg目录。

## SAN存储

SAN存储映射到本机的设备：

GFS：/dev/vmc/serial-***à/dev/dm-***（块设备）àmountà目录

NFS：/home/share

IP-SAN：/dev/vmc/serial-***（LUN）à/dev/dm-***

### NFS存储

​	NFS存储的基本步骤如下：

​	1、创建存储单元对应的目录：mkdir –p /storage_unit_connection_dir

​	2、只读打开文件/etc/export：fopen(“/etc/export”,r)

​	3、更新配置文件设置：echo 

​	4、关闭文件：fclose(fp)

​	5、重启服务：export -a

### CIFS存储

### GFS2存储

## vSAN

​	vSAN映射到本机的设备：

​	Ceph：/dev/CEPH-***（repos）à/dev/rbd*（device）

​	EBS：/dev/EBS-***（repos）à/dev/ebs/*（deivce）

### Ceph存储

### EBS存储

# 相关指令

## df

## du

​	du（disk usage），含义为显示磁盘空间的使用情况，统计目录（或文件）所占磁盘空间的代销。该命令的功能时逐级进入指定目录的每一个子目录并显示该目录占用文件系统数据块（1024字节）的情况。若没有给出指定目录，则对当前目录进行统计。

​	du命令选项：

​	-s：对每个names参数只给出占用的数据库总数

​	-a：递归地显示指定目录中各文件及子目录中各文件占用的数据块数，若既不指定-s，也不指定-a，则只显示names中的每一个目录及其中的各子目录所占的磁盘块数

​	-b：以字节为单位列出磁盘空间使用情况（默认以k字节为单位）

​	-k：以1024字节为单位列出磁盘空间的使用情况

​	-c：最后再加上一个总计（系统默认设置）

​	-l：计算所有的文件大小，对硬链接文件，则计算多次

​	-x：跳过在不同文件系统上的目录不予统计

## fdisk

​	可以划分磁盘分区或者fdisk –l查看完整的磁盘信息。

## parted

 

# 现网问题